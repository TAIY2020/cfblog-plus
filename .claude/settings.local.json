{
  "permissions": {
    "allow": [
      "Bash(ls:*)",
      "WebFetch(domain:cdnjs.webstatic.cn)",
      "WebFetch(domain:cdn.jsdelivr.net)",
      "WebFetch(domain:npm.webcache.cn)",
      "WebFetch(domain:over.alnk.cn)",
      "Bash(head:*)",
      "WebSearch",
      "WebFetch(domain:www.cnblogs.com)",
      "WebFetch(domain:aem1k.com)",
      "Bash(curl:*)",
      "Bash(node:*)",
      "Bash(cygpath:*)",
      "WebFetch(domain:taiyblog.de5.net)",
      "Bash(\"E:/OneDrive/Mine/Coding/git/cfblog-plus/fix-css-filters.ps1\" << 'PSEOF'\n# Script to remove IE filter properties from main.css \\(lines 6000+\\)\n$filePath = 'E:\\\\OneDrive\\\\Mine\\\\Coding\\\\git\\\\cfblog-plus\\\\themes\\\\taiy-blog\\\\files\\\\main.css'\n\n# Read all lines\n$lines = [System.IO.File]::ReadAllLines\\($filePath, [System.Text.Encoding]::UTF8\\)\n$totalLines = $lines.Count\nWrite-Host \"Total lines: $totalLines\"\n\n$newLines = [System.Collections.Generic.List[string]]::new\\(\\)\n$removedCount = 0\n$replacedCount = 0\n\nfor \\($i = 0; $i -lt $totalLines; $i++\\) {\n    $lineNum = $i + 1\n    $line = $lines[$i]\n\n    # Only process lines from 6000 onwards\n    if \\($lineNum -lt 6000\\) {\n        $newLines.Add\\($line\\)\n        continue\n    }\n\n    # Check if this is a filter: alpha\\(opacity=...\\) line\n    if \\($line -match '^\\\\s*filter:\\\\s*alpha\\\\\\(opacity=\\(\\\\d+\\)\\\\\\)\\\\s*;?\\\\s*\\) {\n        $opacityVal = $Matches[1]\n\n        # Check if any preceding line in same block has opacity: or background: rgba\\(\n        $hasOpacity = $false\n        for \\($j = $i - 1; $j -ge [Math]::Max\\(0, $i - 10\\); $j--\\) {\n            if \\($lines[$j] -match '^\\\\s*opacity:'\\) {\n                $hasOpacity = $true\n                break\n            }\n            if \\($lines[$j] -match '^\\\\s*background:\\\\s*rgba\\\\\\('\\) {\n                $hasOpacity = $true\n                break\n            }\n            if \\($lines[$j] -match '[\\\\{\\\\}]'\\) {\n                break\n            }\n        }\n\n        if \\(-not $hasOpacity\\) {\n            # Replace with opacity property\n            $indent = ''\n            if \\($line -match '^\\(\\\\s*\\)'\\) { $indent = $Matches[1] }\n            $decimalVal = [int]$opacityVal / 100.0\n            if \\($decimalVal -lt 1\\) {\n                $formatted = $decimalVal.ToString\\(\\).TrimStart\\('0'\\)\n            } else {\n                $formatted = $decimalVal.ToString\\(\\)\n            }\n            $newLines.Add\\(\"${indent}opacity: $formatted\"\\)\n            $replacedCount++\n            Write-Host \"Line ${lineNum} REPLACED: $\\($line.Trim\\(\\)\\) -> opacity: $formatted\"\n        } else {\n            $removedCount++\n            Write-Host \"Line ${lineNum} REMOVED: $\\($line.Trim\\(\\)\\)\"\n        }\n        continue\n    }\n\n    # Remove filter: progid:DXImageTransform lines\n    if \\($line -match '^\\\\s*filter:\\\\s*progid:DXImageTransform'\\) {\n        $removedCount++\n        Write-Host \"Line ${lineNum} REMOVED: $\\($line.Trim\\(\\)\\)\"\n        continue\n    }\n\n    $newLines.Add\\($line\\)\n}\n\nWrite-Host \"\"\nWrite-Host \"Summary: Removed $removedCount lines, Replaced $replacedCount lines\"\nWrite-Host \"New total lines: $\\($newLines.Count\\)\"\n\n# Write back with UTF-8 no BOM, LF line endings\n$content = $newLines -join \"`n\"\n[System.IO.File]::WriteAllText\\($filePath, $content + \"`n\", \\(New-Object System.Text.UTF8Encoding\\($false\\)\\)\\)\nWrite-Host \"File written successfully.\"\nPSEOF)",
      "Bash(powershell -NoProfile -ExecutionPolicy Bypass -File:*)",
      "Bash(\"E:/OneDrive/Mine/Coding/git/cfblog-plus/fix-css-filters2.ps1\" << 'PSEOF'\n$filePath = 'E:\\\\OneDrive\\\\Mine\\\\Coding\\\\git\\\\cfblog-plus\\\\themes\\\\taiy-blog\\\\files\\\\main.css'\n$lines = [System.IO.File]::ReadAllLines\\($filePath, [System.Text.Encoding]::UTF8\\)\n$totalLines = $lines.Count\n\n$newLines = [System.Collections.Generic.List[string]]::new\\(\\)\n$removedCount = 0\n\nfor \\($i = 0; $i -lt $totalLines; $i++\\) {\n    $lineNum = $i + 1\n    $line = $lines[$i]\n\n    # Remove the incorrectly inserted opacity: .6 lines that are followed by background: rgba\n    if \\($line -match '^\\\\s*opacity:\\\\s*\\\\.6\\\\s* -and \\($i + 1\\) -lt $totalLines\\) {\n        $nextLine = $lines[$i + 1]\n        if \\($nextLine -match '^\\\\s*background:\\\\s*rgba\\\\\\('\\) {\n            $removedCount++\n            Write-Host \"Line ${lineNum} REMOVED: $\\($line.Trim\\(\\)\\)\"\n            continue\n        }\n    }\n\n    $newLines.Add\\($line\\)\n}\n\nWrite-Host \"\"\nWrite-Host \"Summary: Removed $removedCount lines\"\nWrite-Host \"New total lines: $\\($newLines.Count\\)\"\n\n$content = $newLines -join \"`n\"\n[System.IO.File]::WriteAllText\\($filePath, $content + \"`n\", \\(New-Object System.Text.UTF8Encoding\\($false\\)\\)\\)\nWrite-Host \"File written successfully.\"\nPSEOF)",
      "Bash(git checkout:*)"
    ]
  }
}
